1. SYSTEM OVERVIEW
Objective

Build a desktop-first, institutional-grade MCX options analytics platform that:

Fetches live MCX option chain data

Allows multi-leg option strategies (buy/sell, re-entry, exits)

Computes exact PNL, Greeks, PoP, volatility cone

Displays animated payoff & live T-0 PNL

Persists all data using RocksDB (No SQL)

Runs as a self-contained Electron desktop app

Uses Spring Boot + WebSockets for real-time updates

Entire system lives inside one movable folder

2. NON-FUNCTIONAL REQUIREMENTS

‚ùå No SQL databases

‚úÖ RocksDB only

‚ùå No cloud dependency

‚úÖ Fully local execution

‚ùå Browser-only solution

‚úÖ Electron desktop app

‚úÖ Low-latency live updates (<1s)

‚úÖ Deterministic financial math

‚úÖ Folder portability (no absolute paths)

üß© EPIC 1 ‚Äî BACKEND CORE (SPRING BOOT)
STORY 1.1 ‚Äî Spring Boot Application Bootstrap

Story Name:
BOOTSTRAP_BACKEND_SPRING

Description

Create a Spring Boot application that serves as the single backend service responsible for:

MCX API proxying

Pricing & analytics

Persistence

WebSocket broadcasting

The backend must start cleanly with a single command and run independently of the frontend.

Tools / Tech

Java 17

Spring Boot 3.x

Maven

Embedded Tomcat

Acceptance Criteria

Application starts on configurable port

Health endpoint available

No external service dependency

Runs from within project folder

STORY 1.2 ‚Äî MCX API Proxy Service

Story Name:
MCX_API_PROXY

Description

Implement a service that replicates MCX browser calls:

GetOptionChain

GetOptionChainStrikePrice

The service must:

Inject headers & cookies exactly

Avoid CORS/browser restrictions

Abstract MCX API from frontend

Tools / Tech

Spring RestTemplate / WebClient

Config-based headers

JSON parsing (Jackson)

Acceptance Criteria

Correct MCX response payload returned

Supports commodity & expiry selection

Handles MCX downtime gracefully

STORY 1.3 ‚Äî Pricing & PNL Engine

Story Name:
OPTION_PNL_ENGINE

Description

Implement exact PNL math matching trading desk standards.

Must support:

CE/PE Buy & Sell

Multiple lots

Multiple entries per strike

Partial exits

Strategy-level aggregation

Tools / Tech

Java math (double with care)

Domain models (Position, OptionLeg)

Acceptance Criteria

Expiry PNL curve matches reference image

Flat max loss zones

Correct breakevens

Strategy PNL equals sum of legs

STORY 1.4 ‚Äî T-0 (Live) PNL Engine

Story Name:
LIVE_T0_PNL_CALCULATION

Description

Calculate real-time PNL using:

Live option LTP

Entry prices

Direction (buy/sell)

Must NOT use intrinsic value.

Tools / Tech

MCX strike price API

Scheduled recalculation

Acceptance Criteria

Live PNL updates every second

Correct sign for buy/sell

Matches real broker PNL behavior

üìä EPIC 2 ‚Äî GREEKS & QUANTS
STORY 2.1 ‚Äî Black-Scholes Pricing Engine

Story Name:
BLACK_SCHOLES_ENGINE

Description

Implement Black-Scholes model to:

Price CE/PE options

Reverse-calculate implied volatility

Tools / Tech

Java math

Normal distribution approximation

Acceptance Criteria

Prices converge with MCX values

Stable for deep ITM/OTM

No NaN explosions

STORY 2.2 ‚Äî Greeks Calculation Service

Story Name:
OPTION_GREEKS_ENGINE

Description

Compute:

Delta

Theta (daily decay)

Aggregate Greeks at:

Leg level

Strategy level

Tools / Tech

Black-Scholes formulas

Scheduled time decay

Acceptance Criteria

Delta sign correct

Theta negative for long options

Net Greeks update live

STORY 2.3 ‚Äî Greeks Animation Feed

Story Name:
GREEKS_LIVE_STREAM

Description

Continuously stream Greeks over WebSockets so frontend can animate:

Delta drift

Theta burn

Tools / Tech

Spring WebSockets

Scheduled broadcasters

Acceptance Criteria

Smooth per-second updates

No UI freezing

Accurate decay over time

üìà EPIC 3 ‚Äî PROBABILITY & VOLATILITY
STORY 3.1 ‚Äî Probability of Profit Engine

Story Name:
PROBABILITY_OF_PROFIT_ENGINE

Description

Calculate Probability of Profit using lognormal price distribution:

Uses volatility

Uses breakevens

Uses time to expiry

Tools / Tech

Statistical math

Normal CDF

Acceptance Criteria

PoP similar to industry tools

Matches reference (~38‚Äì40%)

Stable across strikes

STORY 3.2 ‚Äî Volatility Cone Generator

Story Name:
VOLATILITY_CONE_ENGINE

Description

Generate volatility cone using:

Historical or implied volatility

1œÉ and 2œÉ price ranges

Tools / Tech

Exponential price bounds

Time-weighted volatility

Acceptance Criteria

Correct cone widening with time

Overlay-ready output

Consistent with IV levels

üóÑ EPIC 4 ‚Äî PERSISTENCE (ROCKSDB)
STORY 4.1 ‚Äî RocksDB Integration

Story Name:
ROCKSDB_PERSISTENCE_LAYER

Description

Integrate RocksDB as the only persistence layer for:

Positions

Entries & exits

Historical PNL

Greeks history

Tools / Tech

RocksDB Java API

Binary serialization

Acceptance Criteria

Data survives restart

Fast read/write

No SQL usage anywhere

STORY 4.2 ‚Äî Historical Analytics Store

Story Name:
HISTORICAL_PNL_STORAGE

Description

Persist time-series:

PNL snapshots

Greeks snapshots

Used for historical charts.

Tools / Tech

RocksDB key ranges

Timestamp indexing

Acceptance Criteria

Accurate historical graphs

Efficient retrieval

No memory leaks

üåê EPIC 5 ‚Äî REAL-TIME COMMUNICATION
STORY 5.1 ‚Äî WebSocket Infrastructure

Story Name:
WEBSOCKET_LIVE_UPDATES

Description

Provide WebSocket endpoints for:

Live PNL

Spot price

Greeks

Volatility

Tools / Tech

Spring WebSocket + STOMP

Acceptance Criteria

Clients auto-reconnect

Broadcast frequency configurable

No blocking calls

üé® EPIC 6 ‚Äî FRONTEND (HTML5)
STORY 6.1 ‚Äî Strategy Builder UI

Story Name:
OPTION_STRATEGY_BUILDER_UI

Description

Enable users to:

Select commodity, expiry

Add/remove option legs

Buy/Sell CE/PE

Re-enter same strike at different prices

Update exits

Tools / Tech

HTML5

Vanilla JS

JSON file-based dropdowns

Acceptance Criteria

Unlimited legs

Correct PNL reflection

No reload required

STORY 6.2 ‚Äî Animated Payoff Graph

Story Name:
ANIMATED_PAYOUT_GRAPH

Description

Render:

Expiry PNL curve

Live T-0 PNL curve

Spot price marker

Volatility cone overlay

Tools / Tech

Chart.js / Canvas

Animation frames

Acceptance Criteria

Smooth animation

Clear breakevens

Matches reference visual

STORY 6.3 ‚Äî Greeks & Metrics Panel

Story Name:
LIVE_GREEKS_DASHBOARD

Description

Display:

Delta

Theta

Max profit/loss

Risk-reward

PoP %

Tools / Tech

WebSocket subscription

Reactive UI updates

Acceptance Criteria

Updates every second

Zero refresh required

No lag spikes

üñ• EPIC 7 ‚Äî ELECTRON DESKTOP
STORY 7.1 ‚Äî Electron App Wrapper

Story Name:
ELECTRON_DESKTOP_APP

Description

Wrap frontend + backend into a desktop app that:

Launches Spring Boot backend

Loads frontend UI

Runs cross-platform

Tools / Tech

Electron

Node.js

Acceptance Criteria

Single-click startup

No browser needed

App closes cleanly

‚öôÔ∏è EPIC 8 ‚Äî DEVOPS & OPERABILITY
STORY 8.1 ‚Äî Single-Folder Deployment

Story Name:
PORTABLE_SINGLE_FOLDER_SETUP

Description

Ensure entire system:

Runs from one root folder

No absolute paths

Configurable via files

Tools / Tech

Relative paths

External config JSON

Acceptance Criteria

Zip & unzip works

No hard-coded paths

Same behavior everywhere

STORY 8.2 ‚Äî Configuration Management

Story Name:
FILE_BASED_CONFIGURATION

Description

Support config via JSON:

Lot sizes

Bid-ask constraints

Refresh intervals

Risk-free rate

Tools / Tech

JSON parsing

Hot reload optional

Acceptance Criteria

No recompilation needed

Config changes reflected live

üß© EPIC 9 ‚Äî POSITION LIFECYCLE & STATE MANAGEMENT
STORY 9.1 ‚Äî Position-Centric Data Model & DB Source of Truth

Story Name:
POSITION_AS_SOURCE_OF_TRUTH

Description

Define a position-centric domain model where:

Commodity

Expiry

StrikePrice

CE/PE

Buy/Sell
are always derived from stored positions in RocksDB, not from UI state.

All downstream operations (PNL, Greeks, strike price fetch, T-0 pricing) must reference the persisted position.

Tools / Tech

Spring Boot

RocksDB

Domain-driven design (Position ‚Üí Entries ‚Üí Legs)

Acceptance Criteria

StrikePrice & Commodity always loaded from DB

No calculation uses UI-only values

Restart preserves exact state

STORY 9.2 ‚Äî Multi-Entry Same-Strike Support

Story Name:
MULTI_ENTRY_SAME_STRIKE

Description

Allow users to:

Enter the same strike multiple times

At different prices

With different directions (buy/sell)

Each entry is treated as an independent leg but aggregates correctly at position level.

Tools / Tech

Java collections

Aggregation logic in Pricing Service

RocksDB persistence

Acceptance Criteria

Unlimited entries per strike

Correct PNL aggregation

Correct Greeks aggregation

No overwriting of previous entries

STORY 9.3 ‚Äî Exit Price Update & Partial Exit Handling

Story Name:
EXIT_PRICE_UPDATE_ENGINE

Description

Enable users to:

Update exit price for each individual entry

Perform partial exits

Recalculate realized vs unrealized PNL

Tools / Tech

REST API

RocksDB updates

Immutable entry history (append-only)

Acceptance Criteria

Exit updates persist correctly

Realized PNL locked

Unrealized PNL continues live

No corruption of history

üß© EPIC 10 ‚Äî HISTORICAL POSITIONS & REPORTING
STORY 10.1 ‚Äî Historical Positions Registry

Story Name:
HISTORICAL_POSITIONS_REGISTRY

Description

Maintain a dedicated historical positions index:

Each position stored with lifecycle timestamps

Open / Closed / Partially Closed status

Tools / Tech

RocksDB key-range indexing

Position snapshots

Acceptance Criteria

All past positions visible after restart

Status correct

No data loss

STORY 10.2 ‚Äî Per-Position PNL Calculation & Storage

Story Name:
POSITION_LEVEL_PNL_CALCULATION

Description

Compute and store:

PNL per position (not only per strategy)

Realized + Unrealized breakdown

Tools / Tech

Pricing Service

Scheduled snapshots

RocksDB persistence

Acceptance Criteria

Position PNL matches sum of entries

Historical PNL immutable

Live PNL updates independently

STORY 10.3 ‚Äî Historical PNL Graph Rendering

Story Name:
HISTORICAL_PNL_GRAPH_UI

Description

Render a dedicated UI section showing:

One PNL graph per position

Timeline-based PNL evolution

Entry / exit markers

Tools / Tech

HTML5 Canvas / Chart.js

RocksDB historical data fetch

Acceptance Criteria

Correct PNL timeline

Smooth rendering

No page reload

üß© EPIC 11 ‚Äî STRATEGY SUGGESTION & PRE-TRADE ANALYTICS
STORY 11.1 ‚Äî Max PNL Suggestion at Entry Time

Story Name:
MAX_PNL_PRE_TRADE_SUGGESTION

Description

Before a position is finalized, the system must:

Simulate payoff

Compute Max Profit / Max Loss

Display to user before entry confirmation

Tools / Tech

Pricing engine

Frontend preview panel

Acceptance Criteria

Preview matches actual post-trade PNL

No lag

Mandatory display before confirmation

STORY 11.2 ‚Äî Straddle Strategy Auto-Suggestion

Story Name:
BEST_STRADDLE_SUGGESTION_ENGINE

Description

Scan option chain to suggest:

Best ATM straddle (4 legs)

Highest expected PNL or best risk-reward

Constraints:

Bid-Ask spread ‚â§ configurable %

Lot size respected

Tools / Tech

Option Chain Service

Pricing & PoP engine

Config-driven constraints

Acceptance Criteria

Suggestions respect bid-ask rule

Correct leg construction

Ranked output

STORY 11.3 ‚Äî Strangle Strategy Auto-Suggestion

Story Name:
BEST_STRANGLE_SUGGESTION_ENGINE

Description

Scan OTM strikes to suggest:

Best PE + CE strangle (4 legs)

Configurable distance from ATM

Spread constraint enforced

Tools / Tech

Option Chain analysis

Probability & PNL ranking

Acceptance Criteria

Valid strangle legs only

Spread ‚â§ config %

Suggestions explain rationale

STORY 11.4 ‚Äî Bid-Ask Spread Validation Engine

Story Name:
BID_ASK_SPREAD_VALIDATION

Description

Central engine to:

Reject strikes where
(ask - bid) / bid > config.maxBidAskDiffPercent

Used by all strategy suggestions

Tools / Tech

Config JSON

Validation utilities

Acceptance Criteria

Configurable without code change

Applied consistently everywhere

Logged for transparency